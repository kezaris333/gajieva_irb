//–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –ø–µ—Ä–µ–≤–æ–¥–∞ —á–∏—Å–ª–∞ –∏–∑ –¥–µ—Å—è—Ç–∏—á–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —Å—á–∏—Å–ª–µ–Ω–∏—è –≤ —Å–∏—Å—Ç–µ–º—É —Å—á–∏—Å–ª–µ–Ω–∏—è —Å
//–æ—Å–Ω–æ–≤–∞–Ω–∏–µ–º 2^ùëü, ùëü = 1, ‚Ä¶, 5 (—Å–∏—Å—Ç–µ–º—ã 2,4,8,16,32).–ü—Ä–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–∑—Ä–µ—à–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏—Ç–æ–≤—ã–µ 
//–æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ –ø–∞–º—è—Ç–∏, –∑–∞–ø—Ä–µ—â–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ
//–∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏.–ü—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–π—Ç–µ —Ä–∞–±–æ—Ç—É —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏.

#pragma warning(disable: 4996)
#include <stdio.h>

void reverse_string(char* str, int length) {
	int start = 0;
	int end = length- 1;

	while (start < end) {
		char temp = str[start];
		str[start] = str[end];
		str[end] = temp;
		start++; 
		end--; //-1
	}
}


int plus(int number, int carry) {
	//int carry = 1; //—É–Ω–∂–Ω–æ –ø—Ä–∏–±–∞–≤–∏—Ç—å –µ–¥–∏–Ω–∏—Ü—É
	while (carry != 0) { //–æ–ø–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è, –ø–æ–∫–∞ –µ—Å—Ç—å –ø–µ—Ä–µ–Ω–æ—Å
		int sum = number ^ carry;  //101^001 = 100 
		carry = (number & carry) << 1; //—Å—á–∏—Ç–∞–µ–º –ø–µ—Ä–µ–Ω–æ—Å 101 & 001 == 001 (—É–º–Ω–æ–∂)  carry = 001
		number = sum;  //—á–∏—Å–ª–æ = 100
	}
	return number; 
}

int minus_one(int number) {
	number = ~number;
	return plus(number, 1); //+1
}

void convert_to_r(int r, int num)  //–Ω–∞–ø—Ä–∏–º–µ—Ä num =1900, r=5
{ //–º–∞—Å–∫–∞ –¥–ª—è –ø–æ–ª—É–µ—á–Ω–∏—è –æ—Å—Ç–∞—Ç–∫–∞ –æ—Ç –¥–µ–ª–µ–Ω–∏—è –Ω–∞ 2^r
		if (r < 1 || r > 5) {
			printf("–ù–µ–≤–µ—Ä–Ω–æ–µ –æ—Å–Ω–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã —Å—á–∏—Å–ª–µ–Ω–∏—è! –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç 2 –¥–æ 32.\n");
			return;
		}

	unsigned int mask = minus_one((1 << r)); //–ø–æ–ª—É—á–∏–º –º–∞—Å–∫—É 11111 –∏–ª–∏–∏ 31
	char result[64];
	int index = 0;

	//–µ—Å–ª–∏ —á–∏—Å–ª–æ 0, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –æ—Ç–¥–µ–ª—å–Ω–æ
	if (!num) {
		result[0] = '0';
		result[1] = '\0';
		printf("—á–∏—Å–ª–æ –≤ —Å–∏—Å—Ç–µ–º–µ –æ—Å–Ω–æ–≤–∞–Ω–∏—è 2^%d: %s\n", r, result);
		return;
	}

	while (num > 0) {//–ø–æ–ª—É—á–∞–µ–º –æ—Å—Ç–∞—Ç–æ–∫ –ø—Ä–∏ –¥–µ–ª–µ–Ω–∏–∏ —Å –ø–æ–º–æ—â—å—é –ø–æ–±–∏—Ç–æ–≤–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ . –¥–µ–ª–µ–Ω–∏–µ –Ω–∞ 2 = —É–±—Ä–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –±–∏—Ç, –Ω–∞ 4 = –ø–æ—Å–ª–µ–¥–Ω–∏–µ –¥–≤–∞ –±–∏—Ç–∞ –∏ —Ç–¥
		unsigned int balance = num & mask; //12345 & 31 = 13 (1101)

		if (balance < 10)

		{
			result[index] = '0' + balance; //–µ—Å–ª–∏ –æ—Å—Ç–∞—Ç–æ–∫ –º–µ–Ω—å—à–µ 10, —Ç–æ —ç—Ç–æ —Ü–∏—Ñ—Ä–∞
			//–ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø–æ–º–µ–Ω—è—Ç—å + –Ω–∞ |
		}
		else
		{
			result[index] = 'A' + (balance - 10); //–µ—Å–ª–∏ –æ—Å—Ç–∞—Ç–æ–∫ –±–æ–ª—å—à–µ 10, —Ç–æ —ç—Ç–æ —Å–∏–º–≤–æ–ª
		}

		plus (index, 1);
		num = num >> r; //—Å–¥–≤–∏–≥ –¥–ª—è –¥–µ–ª–µ–Ω–∏—è –Ω–∞ 2^r/ –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –∏—Ç–µ—Ä–∞—Ü–∏—è num —Å—Ç–∞–Ω–µ—Ç 385  12345>>5

	}
	result[index] = '\0';

	//—Ä–µ–≤–µ—Ä—Å —Å—Ç—Ä–æ–∫–∏
	reverse_string(result, index);

	printf("—á–∏—Å–ª–æ –≤ —Å–∏—Å—Ç–µ–º–µ –æ—Å–Ω–æ–≤–∞–Ω–∏—è 2^%d  %s ", r, result);


}


int main() {

	int num;
	int r;

	printf("–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ –≤ –¥–µ—Å—è—Ç–∏—á–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ");
	scanf_s("%d", &num);
	printf("\n–í–≤–µ–¥–∏—Ç–µ —Å—Ç–µ–ø–µ–Ω—å —á–∏—Å–ª–∞ r –æ—Ç 1 –¥–æ 5 (2^r)\n");
	scanf_s("%d", &r);
	if (r < 1 || r > 5)
	{
		printf("/n –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç–µ–ø–µ–Ω—å");
		return -1;
	}

	convert_to_r(r, num);

	return 0;

}
